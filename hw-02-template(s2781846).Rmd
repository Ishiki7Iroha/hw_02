---
title: "hw-02(s2781846)"
author: "Jason Zeng(s2781846)"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
## **DO NOT EDIT THIS CODE CHUNK**
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
```

```{r}
strava_runs <- read_csv("data/strava_runs.csv")
```

```{r}
data_5k_10k <- strava_runs %>%
  mutate(
    event = case_when(
      distance..m. > 4998 & distance..m. < 5015  ~ "5k",
      distance..m. > 9998 & distance..m. < 10015 ~ "10k",
      TRUE ~ NA_character_
    )
  ) %>%
  filter(!is.na(event))
```


## Exercise 1

```{r ex1a, out.width="80%"}
data_5k_10k %>% 
  filter(gender == "M") %>%
  filter(!is.na(average.heart.rate..bpm.)) %>%
  ggplot(aes(x = average.heart.rate..bpm.)) + 
  geom_histogram(bins = 20)
```

  The histogram is in a shape of normal distribution. Most male runners'average heart rate is around 150 bpm. Also, It is very rare for people who have lower than 125bpm and higher than 175 bpm. There is a small peak around 125 bpm. 
```{r ex1b, out.width="80%"}
# Write your code for Ex1b here
data_5k_10k %>% 
  filter(gender == "F") %>%
  filter(!is.na(average.heart.rate..bpm.)) %>%
  ggplot(aes(x = average.heart.rate..bpm.)) + 
  geom_histogram(bins = 20)

```


_Write your text to answer exercise 1b here (Please delete this message before submission!)_

Compare it to the first histogram, the histogram of female runner is kind of biased to the right. This means more female runners are having a higher average heart rate. And also, the second histogram is more discrete. There are two peaks, one is at around 150 and another one is around 170.
## Exercise 2

```{r ex2, out.width = "80%"}
# calculate pace
data_5k_10k$pace <- (data_5k_10k$elapsed.time..s. * 1000) / (data_5k_10k$distance..m. * 60)

# plot
data_5k_10k %>%
  filter(!is.na(gender)) %>%
  ggplot(aes(x = event, y = pace, fill = gender)) +
  geom_boxplot() +
  labs(title = "Pace (in minutes per km) achieved in 5K and 10K runs, distinguished by gender",
       y = "5K or 10K", 
       x = "Pace (minutes/km)") +
  scale_fill_manual(values = c("lightblue", "lightpink")) +
  theme_minimal()
```

_Write your text to answer exercise 2b here (Please delete this message before submission!)_
On average, male runners need less time to run a kilometers compare to female runners. This has be shwon on both 5k and 10k samples.



## Exercise 3

```{r ex3, out.width = "80%"}
# add some rows together since they are all measuring the same run
consolidated_data <- strava_runs %>%
  group_by(athlete,as_date(timestamp,format = "%d/%m/%Y %H:%M")) %>%
  summarise(
    total_distance = sum(distance..m., na.rm = TRUE),
    total_time = sum(elapsed.time..s., na.rm = TRUE)
  ) %>%
  ungroup()
#translate seconds to minutes
translate_data<-consolidated_data%>%
mutate(
  run_average_speed = consolidated_data$total_distance/consolidated_data$total_time
)
translate_data$total_distance<-translate_data$total_distance/1000 #change it to km
#view(consolidated_data)
class(translate_data)
filter
data_13_7 <- translate_data %>%
  mutate(
    type = case_when(
      total_distance < 7  ~ "long_distance_runner",
      total_distance > 13 ~ "short_distance_runner",
     TRUE ~ NA_character_
    )
  ) %>%
  filter(!is.na(type))
#plot
ggplot(data = data_13_7,
       mapping = aes(x = total_distance, 
                     y = run_average_speed, 
                     colour = type)) +
  geom_point()+
  labs(title = "Speed vs Distance for Long- and Short-Distance Runners",
       y = "Run average speed(m/s)", 
       x = "Run distance(km)") +
  scale_fill_manual(values = c("orange", "forestgreen")) + ##don't know why it doesn't work
  theme_minimal()
```





## Exercise 4

#### Example of a good data visualisation

```{r ex4_good_viz, echo = FALSE, out.width = "80%"}
 #edit the file path accordingly
#knitr::include_graphics("img/good_viz.png")
```

_Edit the text below by replacing the bold text with the appropriate information to provide a reference for your image (Please delete this message before submission!)_

**Author/Organisation**, "**Title of website**" [Online]. Available at: **URL** (Accessed: **day month year**)


The above image presents a good data visualisation because:

-   _Reason 1_
-   _Reason 2_


#### Example of a bad data visualisation


```{r ex4_bad_viz, echo = FALSE, out.width = "80%"}
# edit the file path accordingly
#knitr::include_graphics("img/bad_viz.png")
```

_Edit the text below by replacing the bold text with the appropriate information to provide a reference for your image (Please delete this message before submission!)_

**Author/Organisation**, "**Title of website**" [Online]. Available at: **URL** (Accessed: **day month year**)



The above image presents a bad data visualisation because:

-   _Reason 1_
-   _Reason 2_


